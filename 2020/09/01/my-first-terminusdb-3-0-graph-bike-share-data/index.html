<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>My First TerminusDB 3.0 Graph ‚Äî Bike Share Data | TerminusDB Blog - News and Tutorials</title>
<meta name="description" content="News and tutorials of TerminusDB.
">

<meta itemprop="name" content="TerminusDB">
<meta itemprop="description" content="Bike tutorial with 3.0. Terminators rule ok. ">
<meta itemprop="image" content="http://blog.terminusdb.com/blog/blog/assets/uploads/capture.jpg">

<meta property="og:url" content="http://blog.terminusdb.com/blog/2020/09/01/my-first-terminusdb-3-0-graph-bike-share-data/">
<meta property="og:type" content="website">
<meta property="og:title" content="My First TerminusDB 3.0 Graph ‚Äî Bike Share Data | TerminusDB Blog - News and Tutorials">
<meta property="og:site_name" content="TerminusDB Blog - News and Tutorials">
<meta property="og:description" content="Bike tutorial with 3.0. Terminators rule ok. ">
<meta property="og:image" content="http://blog.terminusdb.com/blog/blog/assets/uploads/capture.jpg">

<meta name="twitter:url" content="http://blog.terminusdb.com/blog/2020/09/01/my-first-terminusdb-3-0-graph-bike-share-data/">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="My First TerminusDB 3.0 Graph ‚Äî Bike Share Data | TerminusDB Blog - News and Tutorials">
<meta name="twitter:site" content="TerminusDB Blog - News and Tutorials">
<meta name="twitter:description" content="Bike tutorial with 3.0. Terminators rule ok. ">

  <meta name="twitter:creator" content="@TerminusDB">

<meta property="twitter:image" content="http://blog.terminusdb.com/blog/blog/assets/uploads/capture.jpg">

<link rel="icon" type="image/x-icon" href="/blog/assets/images/favicon.ico">

<link rel="stylesheet" href="/blog/assets/main.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" />

<link rel="alternate" type="application/rss+xml" title="TerminusDB Blog - News and Tutorials" href="/blog/feed.xml">
<link rel="canonical" href="/blog/2020/09/01/my-first-terminusdb-3-0-graph-bike-share-data/">




</head>
<body id="my-first-terminusdb-3-0-graph-bike-share-data" class="post-layout">
  
  <header class="header">
  <a class="header__title" href="https://terminusdb.com/"><img src="/blog/assets/images/horizontal_lockup.png" style="height: 1.8em; margin-top: 0.8em;"/></a>

  <nav>
  <ul class="header__list">
    <li><a href="/blog">Blog</a></li>
    <li><a href="https://podcast.terminusdb.com/">Podcast</a></li>
    <li><a href="https://terminusdb.com/community/">Community</a></li>
    <li><a href="https://events.terminusdb.com/">Events</a></li>
    <li><a href="https://discord.gg/Gvdqw97">Join Discord</a></li>
  </ul>
</nav>

</header>


  <main class="üíà">

    <div class="post">
  <article itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting" class="h-entry">
    <div class="post__header section-padding--double">
      <div class="grid-small">
        <h2 itemprop="name headline" class="p-name">My First TerminusDB 3.0 Graph ‚Äî Bike Share Data</h2>

        <time class="post__date" datetime="2020-09-01T18:41:35+00:00" itemprop="datePublished">1 Sep 2020</time>
      </div>
    </div>

    
      <div class="post__img u-photo">
        <div>
          <figure class="absolute-bg" style="background-image: url('/blog/assets/uploads/capture.jpg'); background-size: contain;"></figure>
        </div>
      </div>
    

    
      <div class="post__img u-photo">
        <div>
          <figure class="absolute-bg" style="background-image: url('https://miro.medium.com/max/10944/1*wHpEF7tcwMY0OqIC33mxKA.jpeg');"></figure>
        </div>
      </div>
    

    <div class="post__content section-padding">
      <div class="grid">
        <div id="markdown" itemprop="articleBody" class="e-content">
          <p>In this tutorial, we will start using TerminusDB 3.0, TerminusDB Console and its query client. This is a step-by-step guide to create your first knowledge graph.</p>

<p>We‚Äôre assuming you already have TerminusDB installed, but if you haven‚Äôt go to our <a href="https://terminusdb.com/hub/download">download center</a>. It‚Äôs very easy to get started.</p>

<p>In this tutorial, we are going to import data from CSVs about bike journeys between stations in Washington D.C., USA, build a knowledge graph from the data, analyze and visualize it. The data is taken from Capital Bike Share (available <a href="https://www.capitalbikeshare.com/system-data">here</a> ‚Äî thanks folks) and the CSV data used this tutorial is available at <a href="https://terminusdb.com/t/data/bike_tutorial.csv">https://terminusdb.com/t/data/bike_tutorial.csv</a></p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/6BK5tPHKryc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<hr />

<h1 id="create-a-database">Create a Database</h1>

<p>Open up the TerminusDB console (https://127.0.0.1:6363/ ‚Äî go to our <a href="https://terminusdb.com/hub/download">download center</a> to get up and running). Click on <code class="highlighter-rouge">Create</code> to start.</p>

<p>Click on <code class="highlighter-rouge">Create</code> to start and select ‚ÄòTerminusHub Database‚Äô as we want to share this with the world.</p>

<p>You can specify an id for the database, to make it memorable, let‚Äôs make it <code class="highlighter-rouge">1stdb</code> (note that Terminus IDs are URLs and they cannot have spaces!). As a title, enter the name you want to give your Database, something meaningful like <code class="highlighter-rouge">My First Database</code>. Then you can add a short description to your database, like <code class="highlighter-rouge">It is my first database using TerminusDB</code>.</p>

<p><img src="/blog/assets/uploads/capture.jpg" alt="Create Database" /></p>

<p>Click the <code class="highlighter-rouge">Create On TerminusDB</code> button at the top right, and you‚Äôll automatically go to the main database page. Something like this:</p>

<p><img src="/blog/assets/uploads/db-home.jpg" alt="Successfully created Database" /></p>

<p>Now we have a database, let‚Äôs have a look at the data we want to import. Click on the <code class="highlighter-rouge">Query</code> link in the left hand menu and you should see a query page that looks like the screen below.</p>

<hr />

<hr />

<h1 id="lets-create-a-schema">Let‚Äôs Create a Schema</h1>

<p>The schema allows you to organize data into meaningful objects, and it ensures data integrity ‚Äî nothing goes into your database that is not in the schema. This is a TerminusDB super power ‚Äî and ensures you derive long term value from your data.</p>

<p>The TerminusDB Console provides a schema editor using WOQL.js. Remaining on the query page, copy this WOQL.js query into the text box:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span>         
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">doctype</span><span class="p">(</span><span class="dl">"</span><span class="s2">Station</span><span class="dl">"</span><span class="p">)</span>             
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bike Station</span><span class="dl">"</span><span class="p">)</span>             
        <span class="p">.</span><span class="nx">description</span><span class="p">(</span><span class="dl">"</span><span class="s2">A station where bicycles are deposited</span><span class="dl">"</span><span class="p">),</span>         
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">doctype</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bicycle</span><span class="dl">"</span><span class="p">)</span>             
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bicycle</span><span class="dl">"</span><span class="p">),</span>         
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">doctype</span><span class="p">(</span><span class="dl">"</span><span class="s2">Journey</span><span class="dl">"</span><span class="p">)</span>             
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">Journey</span><span class="dl">"</span><span class="p">)</span>             
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">start_station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Station</span><span class="dl">"</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start Station</span><span class="dl">"</span><span class="p">)</span>             
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">end_station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Station</span><span class="dl">"</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">End Station</span><span class="dl">"</span><span class="p">)</span>                                                
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">integer</span><span class="dl">"</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">Journey Duration</span><span class="dl">"</span><span class="p">)</span>         
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">start_time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">dateTime</span><span class="dl">"</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">Time Started</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">end_time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">dateTime</span><span class="dl">"</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">Time Ended</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">journey_bicycle</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Bicycle</span><span class="dl">"</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bicycle Used</span><span class="dl">"</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div>

<p>Add a commit message in the box above (e.g. ‚ÄúAdd Schema‚Äù) and click <code class="highlighter-rouge">Run Query</code></p>

<p><img src="/blog/assets/uploads/add-schema.jpg" alt="" /></p>

<p>It worked!</p>

<p><img src="/blog/assets/uploads/success-schema.jpg" alt="" /></p>

<p>Let‚Äôs stop to review this schema-building query:</p>

<p>We perform all operations within the <code class="highlighter-rouge">and</code>.</p>

<p>So here‚Äôs the operations we have performed:</p>

<ol>
  <li>We created three different document types (given by the <code class="highlighter-rouge">doctype</code>function): <code class="highlighter-rouge">Station</code> , <code class="highlighter-rouge">Journey</code> and <code class="highlighter-rouge">Bicycle</code></li>
  <li>We added <code class="highlighter-rouge">label</code> (names) or <code class="highlighter-rouge">description</code> (short descriptions) to them.</li>
  <li>We created properties for <code class="highlighter-rouge">Journey</code>, we do that by using the <code class="highlighter-rouge">property</code> function after <code class="highlighter-rouge">Journey</code> with the first argument as the name of the property and the second argument as the type (or range) of the property.</li>
  <li>For each property, you have to provide an id and the type of that property in <code class="highlighter-rouge">property</code>, as with class you can add a <code class="highlighter-rouge">label</code> to it as well.</li>
</ol>

<p>We can view the result by clicking the ‚ÄòSchema‚Äô tab:</p>

<p><img src="/blog/assets/uploads/schema-view.jpg" alt="showing classes in schema" /></p>

<hr />

<h1 id="lets-load-in-the-data">Let‚Äôs Load in the Data</h1>

<p>Now let‚Äôs get to the good part. We‚Äôll now load the data from the CSV. We‚Äôre going to progressively extend the query to import the data, cleaning it and matching it as we go. WOQL is a highly composable language, you can combine queries arbitrarily using logical ANDs and ORs.</p>

<p><strong>Let‚Äôs build the next query in steps and only hit</strong><code class="highlighter-rouge">Run Query</code><strong>at the end of the query (full query is available at the bottom of the section)</strong></p>

<p>Go back to the <code class="highlighter-rouge">Query</code> page, and copy in the following query:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//Read data from CSV</span>
<span class="kd">const</span> <span class="nx">csv</span> <span class="o">=</span> <span class="nx">WOQL</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start station</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Start_Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start date</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_Time</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End date</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Time</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Duration</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start station number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_ID</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End station number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_ID</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bike number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Member type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Member_Type</span><span class="dl">"</span><span class="p">)</span>
<span class="p">).</span><span class="nx">remote</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://terminusdb.com/t/data/bike_tutorial.csv</span><span class="dl">"</span><span class="p">)</span>
<span class="c1">//Transform data into correct shape for insert</span>
<span class="kd">const</span> <span class="nx">wrangles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:integer</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Duration_Cast</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_Time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:dateTime</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ST_Cast</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:End_Time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:dateTime</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ET_Cast</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_Station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:SS_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:End_Station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ES_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Journey</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:Start_ID</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Start_Time</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:Journey_ID</span><span class="dl">"</span><span class="p">),</span>       
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Station</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:Start_ID</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:Start_Station_URL</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Station</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:End_ID</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:End_Station_URL</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Bicycle</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:Bike_Label</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:Bike_URL</span><span class="dl">"</span><span class="p">),</span>    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_ID - v:End_ID @ v:Start_Time</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:J_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bike v:Bike from v:Start_Station to v:End_Station at v:Start_Time until v:End_Time</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Journey_Description</span><span class="dl">"</span><span class="p">)</span>
<span class="p">];</span> 
<span class="c1">//Combine with logical and</span>
<span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span><span class="nx">csv</span><span class="p">,</span> <span class="p">...</span><span class="nx">wrangles</span><span class="p">)</span>
</code></pre></div></div>

<p>We‚Äôll explain each of the steps in this query in turn. As a first step, we saved the part of the query that imports the data from CSV in a <code class="highlighter-rouge">const</code> variable named <code class="highlighter-rouge">csv</code>. Then we create a list of WOQL operators and save it in another constvariable called <code class="highlighter-rouge">wrangles</code>, we combine the two parts of the query with a <code class="highlighter-rouge">WOQL.and</code> operator.</p>

<p>The <code class="highlighter-rouge">wrangles</code> clause uses 3 WOQL functions to transform the data into the correct form for input. In each case, the function creates a new variable as output ‚Äî the last argument in each case. The <code class="highlighter-rouge">idgen</code> function generates IDs for our three document types <code class="highlighter-rouge">Journey</code>, <code class="highlighter-rouge">Station</code>, and <code class="highlighter-rouge">Bicycle</code>. The first argument is the prefix that will be used, the second is a list of variables which combine to give a unique identity for the id. For example, in <code class="highlighter-rouge">Journey</code> we use 3 fields in the <code class="highlighter-rouge">csv</code> (<code class="highlighter-rouge">Start_ID</code>, <code class="highlighter-rouge">Start_Time</code> and <code class="highlighter-rouge">Bike</code>) to generate a unique id <code class="highlighter-rouge">Journey_ID</code>.</p>

<p>Besides generating IDs, we also create new fields with new data types, for example, we use <code class="highlighter-rouge">typecast</code> to cast <code class="highlighter-rouge">Duration</code> into <code class="highlighter-rouge">integer</code> and store it as <code class="highlighter-rouge">Duration_Cast</code>. We can also use <code class="highlighter-rouge">concat</code> to contract new text formatted with variables in the fields ‚Äî for example, to create <code class="highlighter-rouge">Journey_Label</code>.</p>

<p>We‚Äôll insert them in the graph by adding <code class="highlighter-rouge">triples</code>! Triples are the atomic data entity in the RDF data model. We add the following to the query:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">inputs</span> <span class="o">=</span> <span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span><span class="nx">csv</span><span class="p">,</span> <span class="p">...</span><span class="nx">wrangles</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">inserts</span> <span class="o">=</span> <span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Journey_ID</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Journey</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:J_Label</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">description</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Journey_Description</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">start_time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ST_Cast</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">end_time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ET_Cast</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Duration_Cast</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">start_station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_Station_URL</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">end_station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Station_URL</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">journey_bicycle</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike_URL</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_Station_URL</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:SS_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:End_Station_URL</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:ES_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Bike_URL</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Bicycle</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Bike_Label</span><span class="dl">"</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<p>If we hit <code class="highlighter-rouge">Run Query</code> for this section and you should see the following in the <code class="highlighter-rouge">Results Viewer</code> tab:</p>

<p><img src="/blog/assets/uploads/load-in-the-data-1.jpg" alt="" /></p>

<p>Click on the <code class="highlighter-rouge">table</code> drop down menu in the top right of the results and switch to <code class="highlighter-rouge">graph</code> view:</p>

<p><img src="/blog/assets/uploads/graph-of-data-load.jpg" alt="" /></p>

<p>Now you can see your results in graph form.</p>

<p>We‚Äôll explain each of the steps in the query in turn. As a first step, we saved the part of the query that imports the data from CSV in a <code class="highlighter-rouge">const</code> variable named <code class="highlighter-rouge">csv</code>. Then we create a list of WOQL operators and save it in another constvariable called <code class="highlighter-rouge">wrangles</code>, we combine the two parts of the query with a <code class="highlighter-rouge">WOQL.and</code> operator.</p>

<p>The <code class="highlighter-rouge">wrangles</code> clause uses 3 WOQL functions to transform the data into the correct form for input. In each case, the function creates a new variable as output ‚Äî the last argument in each case. The <code class="highlighter-rouge">idgen</code> function generates IDs for our three document types <code class="highlighter-rouge">Journey</code>, <code class="highlighter-rouge">Station</code>, and <code class="highlighter-rouge">Bicycle</code>. The first argument is the prefix that will be used, the second is a list of variables which combine to give a unique identity for the id. For example, in <code class="highlighter-rouge">Journey</code> we use 3 fields in the <code class="highlighter-rouge">csv</code> (<code class="highlighter-rouge">Start_ID</code>, <code class="highlighter-rouge">Start_Time</code> and <code class="highlighter-rouge">Bike</code>) to generate a unique id <code class="highlighter-rouge">Journey_ID</code>.</p>

<p>Besides generating IDs, we also create new fields with new data types, for example, we use <code class="highlighter-rouge">typecast</code> to cast <code class="highlighter-rouge">Duration</code> into <code class="highlighter-rouge">integer</code> and store it as <code class="highlighter-rouge">Duration_Cast</code>. We can also use <code class="highlighter-rouge">concat</code> to contract new text formatted with variables in the fields ‚Äî for example, to create <code class="highlighter-rouge">Journey_Label</code>.</p>

<p>We‚Äôll insert them in the graph by adding <code class="highlighter-rouge">triples.</code> Triples are the atomic data entity in the RDF data model. We add the following to the query:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">inputs</span> <span class="o">=</span> <span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span><span class="nx">csv</span><span class="p">,</span> <span class="p">...</span><span class="nx">wrangles</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">inserts</span> <span class="o">=</span> <span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Journey_ID</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Journey</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:J_Label</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">description</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Journey_Description</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">start_time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ST_Cast</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">end_time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ET_Cast</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Duration_Cast</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">start_station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_Station_URL</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">end_station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Station_URL</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">journey_bicycle</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike_URL</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_Station_URL</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:SS_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:End_Station_URL</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:ES_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Bike_URL</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Bicycle</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Bike_Label</span><span class="dl">"</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<p>This is the clause that actually inserts the data into the structure that we defined on our schema.</p>

<ul>
  <li>The <code class="highlighter-rouge">insert</code> function inserts a new node into the database with the id <code class="highlighter-rouge">Journey_ID</code> and type <code class="highlighter-rouge">Journey</code> we add properties like <code class="highlighter-rouge">start_time</code>, <code class="highlighter-rouge">end_time</code>, <code class="highlighter-rouge">duration</code>, <code class="highlighter-rouge">start_station</code>, <code class="highlighter-rouge">end_station</code> and <code class="highlighter-rouge">label</code> and put the variables produced above in their correct spots.</li>
  <li>For <code class="highlighter-rouge">Start_Station_URL</code>, <code class="highlighter-rouge">End_Station_URL</code> and <code class="highlighter-rouge">Bike_URL</code>, we assign a <code class="highlighter-rouge">type</code> and <code class="highlighter-rouge">label</code> for each of them.</li>
</ul>

<p>Finally, we have to put all of the above together and create the query that reads the data from the csv, do the data wrangling and add them in the graph as triples. We add this to complete the query:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>WOQL.and(inputs, inserts);
</code></pre></div></div>

<p>Write some commit message again (e.g. ‚Äúinserting data‚Äù) and click <code class="highlighter-rouge">Run Query</code>. Remember, this is getting the data in to our graph so you won‚Äôt have a query output just yet.</p>

<p>The little x closes the view pane and the button opens it (both circled in red)</p>

<p>The full query in all it‚Äôs glory and in easy to copy format:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">csv</span> <span class="o">=</span> <span class="nx">WOQL</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start station</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Start_Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start date</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_Time</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End date</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Time</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Duration</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start station number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_ID</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End station number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_ID</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bike number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Member type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Member_Type</span><span class="dl">"</span><span class="p">)</span>
<span class="p">).</span><span class="nx">remote</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://terminusdb.com/t/data/bike_tutorial.csv</span><span class="dl">"</span><span class="p">)</span>
<span class="c1">//Clean data for insert</span>
<span class="kd">const</span> <span class="nx">wrangles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:integer</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Duration_Cast</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_Time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:dateTime</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ST_Cast</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:End_Time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:dateTime</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ET_Cast</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_Station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:SS_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:End_Station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ES_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Journey</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:Start_ID</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Start_Time</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:Journey_ID</span><span class="dl">"</span><span class="p">),</span>       
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Station</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:Start_ID</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:Start_Station_URL</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Station</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:End_ID</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:End_Station_URL</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Bicycle</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:Bike_Label</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:Bike_URL</span><span class="dl">"</span><span class="p">),</span>    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_ID - v:End_ID @ v:Start_Time</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:J_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bike v:Bike from v:Start_Station to v:End_Station at v:Start_Time until v:End_Time</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Journey_Description</span><span class="dl">"</span><span class="p">)</span>
<span class="p">];</span>
<span class="c1">//combine inputs</span>
<span class="kd">const</span> <span class="nx">inputs</span> <span class="o">=</span> <span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span><span class="nx">csv</span><span class="p">,</span> <span class="p">...</span><span class="nx">wrangles</span><span class="p">)</span>
<span class="c1">//generate data to be inserted</span>
<span class="kd">const</span> <span class="nx">inserts</span> <span class="o">=</span> <span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Journey_ID</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Journey</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:J_Label</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">description</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Journey_Description</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">start_time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ST_Cast</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">end_time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ET_Cast</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Duration_Cast</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">start_station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_Station_URL</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">end_station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Station_URL</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">journey_bicycle</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike_URL</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_Station_URL</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:SS_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:End_Station_URL</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:ES_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Bike_URL</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Bicycle</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Bike_Label</span><span class="dl">"</span><span class="p">)</span>
<span class="p">);</span>
<span class="c1">//Combine inputs and inserts with when clause</span>
<span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span><span class="nx">inputs</span><span class="p">,</span> <span class="nx">inserts</span><span class="p">);</span>
</code></pre></div></div>

<p>don‚Äôt forget to put in the commit message, then click <code class="highlighter-rouge">Run Query</code>.</p>

<hr />

<h1 id="query-the-data">Query The Data</h1>

<p>Back to the query page ‚Äî again input into the WOQL.js query builder:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WOQL</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_Label</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Label</span><span class="dl">"</span><span class="p">).</span><span class="nx">and</span><span class="p">(</span>
	<span class="nx">WOQL</span><span class="p">.</span><span class="nx">triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Journey</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">scm:Journey</span><span class="dl">"</span><span class="p">),</span>
	<span class="nx">WOQL</span><span class="p">.</span><span class="nx">triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Journey</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">start_station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start</span><span class="dl">"</span><span class="p">),</span>
	<span class="nx">WOQL</span><span class="p">.</span><span class="nx">opt</span><span class="p">().</span><span class="nx">triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">label</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_Label</span><span class="dl">"</span><span class="p">),</span>
	<span class="nx">WOQL</span><span class="p">.</span><span class="nx">triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Journey</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">end_station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End</span><span class="dl">"</span><span class="p">),</span>
	<span class="nx">WOQL</span><span class="p">.</span><span class="nx">opt</span><span class="p">().</span><span class="nx">triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:End</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">label</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Label</span><span class="dl">"</span><span class="p">),</span>
	<span class="nx">WOQL</span><span class="p">.</span><span class="nx">triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Journey</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">journey_bicycle</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div>

<p>Click on <code class="highlighter-rouge">Run Query</code>and you should see the query returning a table:</p>

<p><img src="/blog/assets/uploads/results.jpg" alt="query returns a table" /></p>

<!--StartFragment-->

<p>Here we used <code class="highlighter-rouge">select</code> to filter out the variables (those starting with <code class="highlighter-rouge">v:</code>) that appear in our output. Then we used <code class="highlighter-rouge">and</code> to link all the conditions we want to include, as you can see there are lot‚Äôs of <code class="highlighter-rouge">triples</code> to be conditioned. The ones with <code class="highlighter-rouge">opt()</code> means that they are optional ‚Äî it will be ignored if that data is missing (instead of returning an error ‚Äî very handy).</p>

<p>The query can be translated as below:</p>

<ol>
  <li>select all the <code class="highlighter-rouge">Journeys</code></li>
  <li>and all the <code class="highlighter-rouge">start_stations</code> of all the <code class="highlighter-rouge">Journeys</code> (let‚Äôs call them <code class="highlighter-rouge">Start</code>)</li>
  <li>and, if any, all the <code class="highlighter-rouge">labels</code> of the <code class="highlighter-rouge">start_stations</code> (let‚Äôs call them <code class="highlighter-rouge">Start_Label</code>)</li>
  <li>and all the <code class="highlighter-rouge">end_stations</code> of all the <code class="highlighter-rouge">Journeys</code> (let‚Äôs call them <code class="highlighter-rouge">End</code>)</li>
  <li>and, if any, all the <code class="highlighter-rouge">labels</code> of the <code class="highlighter-rouge">end_stations</code> (let‚Äôs call them <code class="highlighter-rouge">End_Label</code>)</li>
  <li>and all the <code class="highlighter-rouge">journey_bicycles</code> of all the <code class="highlighter-rouge">Journeys</code> (let‚Äôs call them <code class="highlighter-rouge">Bike</code>)</li>
</ol>

<p>We can click the <code class="highlighter-rouge">table</code> drop down menu in the top right and get a <code class="highlighter-rouge">graph</code> view of the results:</p>

<p><img src="/blog/assets/uploads/results-graph-view.jpg" alt="result as graph" /></p>

<p>You can go back to ‚ÄòDB Home‚Äô to view all of the information about the database, including all your commit messages:</p>

<p><img src="/blog/assets/uploads/db-home-post.jpg" alt="click on the view button" /></p>

<p>Of course, with TerminusHub there is a way to short circuit this tutorial. You can go back to the start, click on ‚ÄòClone‚Äô and copy the bike database in full. You can then immediately run your queries. No need for any interim steps. Life is getting easier!</p>

<p>Terminators first, always!</p>

        </div>

        

<ul class="post__social">
  <li><a href="https://www.facebook.com/sharer/sharer.php?u=http://blog.terminusdb.com/blog/2020/09/01/my-first-terminusdb-3-0-graph-bike-share-data/" target="_blank"><i class="fa fa-facebook"></i></a></li>
  <li><a href="https://twitter.com/intent/tweet?&text=My First TerminusDB 3.0 Graph ‚Äî Bike Share Data+http://blog.terminusdb.com/blog/2020/09/01/my-first-terminusdb-3-0-graph-bike-share-data/+by+" target="_blank"><i class="fa fa-twitter"></i></a></li>
  <li><a href="https://plus.google.com/share?url=http://blog.terminusdb.com/blog/2020/09/01/my-first-terminusdb-3-0-graph-bike-share-data/" target="_blank"><i class="fa fa-google-plus"></i></a></li>
  <li><a href="https://www.linkedin.com/shareArticle?mini=true&source=My First TerminusDB 3.0 Graph ‚Äî Bike Share Data&summary=Bike tutorial with 3.0. Terminators rule ok. &url=http://blog.terminusdb.com/blog/2020/09/01/my-first-terminusdb-3-0-graph-bike-share-data/" target="_blank"><i class="fa fa-linkedin"></i></a></li>
  <li><a href="https://www.stumbleupon.com/badge/?url=http://blog.terminusdb.com/blog/2020/09/01/my-first-terminusdb-3-0-graph-bike-share-data/" target="_blank"><i class="fa fa-stumbleupon"></i></a></li>
  <li><a href="https://www.reddit.com/submit?url=http://blog.terminusdb.com/blog/2020/09/01/my-first-terminusdb-3-0-graph-bike-share-data/" target="_blank"><i class="fa fa-reddit-alien"></i></a></li>
  <li><a href="https://www.tumblr.com/share/link?url=http://blog.terminusdb.com/blog/2020/09/01/my-first-terminusdb-3-0-graph-bike-share-data/" target="_blank"><i class="fa fa-tumblr"></i></a></li>
  <li><a href="https://www.pinterest.com/pin/create/link/?description=Bike tutorial with 3.0. Terminators rule ok. &media=http://blog.terminusdb.com/blog/blog/assets/uploads/capture.jpg&url=http://blog.terminusdb.com/blog/2020/09/01/my-first-terminusdb-3-0-graph-bike-share-data/" target="_blank"><i class="fa fa-pinterest"></i></a></li>
</ul>

      </div>
    </div>

    <!-- Everything inside the #author tags pulls data from the author -->
    
      <div class="section-padding--none">
        <div class="grid p-author h-card">
          <hr class="sep"/>
        </div>
      </div>

      <div class="section-padding">
        <div class="grid-small">
          
            

            
              <span class="post__author">Posted by
            

            <a href="https://github.com/luke-feeney" class="p-name u-url">Luke Feeney</a></span>
            <p class="post__bio p-note">Building the database of the future.</p>

          
        </div>
      </div>
    

    <!--

If you use Disqus comments, just uncomment this block.
The only thing you need to change is "test-apkdzgmqhj" - which
should be replaced with your own Disqus site-id.

<div class="post__comments section-padding">
  <div class="grid-small">
    <div id="disqus_thread"></div>
    <script>
      var disqus_config = function () {
        this.page.url = 'http://blog.terminusdb.com/blog/2020/09/01/my-first-terminusdb-3-0-graph-bike-share-data/';
        this.page.identifier = 'http://blog.terminusdb.com/blog/2020/09/01/my-first-terminusdb-3-0-graph-bike-share-data/';
      };
      (function() {
        var d = document, s = d.createElement('script');
        s.src = 'https://.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>
  </div>
</div>
-->


  </article>
</div>

<!-- Links to Previous/Next posts -->


  <section class="related section-padding">
    <div class="grid-xlarge">
      <h2 class="related__title">Related</h2>
      <div class="related__container">
      
        
        
          <article class="related__post">
            <a class="related__link" href="/blog/2020/09/24/graph-databases-terminusdb-vs-neo4j/"">
              
                <figure class="related__img">
                  <img src="/blog/assets/images/clint-adair-unsplash.jpg" alt="Graph Databases <br>TerminusDB vs Neo4j"/>
                </figure>
              
              
              <div>
                <h2 class="related__text">Graph Databases <br>TerminusDB vs Neo4j</h2>
              </div>
            </a>
          </article>
        
        
        
        
        
          <article class="related__post">
            <a class="related__link" href="/blog/2020/09/15/delta-rollup/"">
              
                <figure class="related__img">
                  <img src="/blog/assets/uploads/cover-1-.jpg" alt="Delta Rollups"/>
                </figure>
              
              
              <div>
                <h2 class="related__text">Delta Rollups</h2>
              </div>
            </a>
          </article>
        
        
        
        
        
        
        
        
          <article class="related__post">
            <a class="related__link" href="/blog/2020/07/24/the-power-of-web-object-query-language/"">
              
                <figure class="related__img">
                  <img src="/blog/assets/uploads/the-power-of-woql.png" alt="The Power of Web Object Query Language"/>
                </figure>
              
              
              <div>
                <h2 class="related__text">The Power of Web Object Query Language</h2>
              </div>
            </a>
          </article>
        
        
        
          
      
        
      
      </div>
    </div>
  </section>


    
  </main>

  <!-- The footer at the very bottom of the screen -->
<footer class="footer section-padding">
  <div class="grid">
    <div class="footer__container">
     <!-- <ul class="footer__tags"><li><a class="footer__link" href="/tag/database">Database</a></li><li><a class="footer__link" href="/tag/data">Data</a></li><li><a class="footer__link" href="/tag/database">Database</a></li><li><a class="footer__link" href="/tag/graph-database">Graph Database</a></li><li><a class="footer__link" href="/tag/data">Data</a></li></ul> -->

      
  <ul class="footer__social">
    
      <li><a href="https://twitter.com/TerminusDB" target="_blank"><i class="fa fa-twitter"></i></a></li>
    
      <li><a href="https://github.com/terminusdb" target="_blank"><i class="fa fa-github"></i></a></li>
    
      <li><a href="https://discord.gg/Gvdqw97" target="_blank"><i class="fa fa-Discord"></i></a></li>
    
      <li><a href="https://www.youtube.com/channel/UC5kZt8pP-FM0u-R0BQr78YA" target="_blank"><i class="fa fa-youtube"></i></a></li>
    
  </ul>


    </div>
  </div>
</footer>


<script src="/blog/assets/js/app.min.js"></script>
<script async defer src="https://scripts.simpleanalyticscdn.com/latest.js"></script>
<noscript><img src="https://queue.simpleanalyticscdn.com/noscript.gif" alt=""/></noscript>
<script>
  var _paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['disableCookies']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
      var u="https://terminusdb.matomo.cloud/";
      _paq.push(['setTrackerUrl', u+'matomo.php']);
      _paq.push(['setSiteId', '1']);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.type='text/javascript'; g.async=true; g.defer=true; g.src='//cdn.matomo.cloud/terminusdb.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>




</body>
</html>
